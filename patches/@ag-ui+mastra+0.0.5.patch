diff --git a/node_modules/@ag-ui/mastra/dist/index.js b/node_modules/@ag-ui/mastra/dist/index.js
index 1234567..abcdefg 100644
--- a/node_modules/@ag-ui/mastra/dist/index.js
+++ b/node_modules/@ag-ui/mastra/dist/index.js
@@ -1 +1 @@
-"use strict";var v=Object.defineProperty,B=Object.defineProperties,H=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertyNames,I=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var D=(e,t,o)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,C=(e,t)=>{for(var o in t||(t={}))E.call(t,o)&&D(e,o,t[o]);if(I)for(var o of I(t))U.call(t,o)&&D(e,o,t[o]);return e},R=(e,t)=>B(e,P(t));var S=(e,t)=>{var o={};for(var n in e)E.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(e!=null&&I)for(var n of I(e))t.indexOf(n)<0&&U.call(e,n)&&(o[n]=e[n]);return o};var K=(e,t)=>{for(var o in t)v(e,o,{get:t[o],enumerable:!0})},q=(e,t,o,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of $(t))!E.call(e,r)&&r!==o&&v(e,r,{get:()=>t[r],enumerable:!(n=H(t,r))||n.enumerable});return e};var W=e=>q(v({},"__esModule",{value:!0}),e);var z={};K(z,{MastraAgent:()=>f,convertAGUIMessagesToMastra:()=>L,getLocalAgent:()=>N,getLocalAgents:()=>T,getNetwork:()=>k,getRemoteAgents:()=>O,registerCopilotKit:()=>X});module.exports=W(z);var d=require("@ag-ui/client"),G=require("@ai-sdk/ui-utils"),x=require("crypto"),j=require("rxjs");var w=require("@copilotkit/runtime"),J=require("@mastra/core/server"),b=require("@mastra/core/runtime-context");function L(e){var o,n;let t=[];for(let r of e)if(r.role==="assistant"){let s=r.content?[{type:"text",text:r.content}]:[];for(let i of(o=r.toolCalls)!=null?o:[])s.push({type:"tool-call",toolCallId:i.id,toolName:i.function.name,args:JSON.parse(i.function.arguments)});t.push({role:"assistant",content:s})}else if(r.role==="user")t.push({role:"user",content:r.content||""});else if(r.role==="tool"){let s="unknown";for(let i of e)if(i.role==="assistant"){for(let l of(n=i.toolCalls)!=null?n:[])if(l.id===r.toolCallId){s=l.function.name;break}}t.push({role:"tool",content:[{type:"tool-result",toolCallId:r.toolCallId,toolName:s,result:r.content}]})}return t}function X({path:e,resourceId:t,serviceAdapter:o=new w.ExperimentalEmptyAdapter,agents:n,setContext:r}){return(0,J.registerApiRoute)(e,{method:"ALL",handler:async s=>{let i=s.get("mastra"),l=new b.RuntimeContext;r&&await r(s,l);let m=n||f.getLocalAgents({resourceId:t,mastra:i,runtimeContext:l}),p=new w.CopilotRuntime({agents:m});return(0,w.copilotRuntimeNodeHttpEndpoint)({endpoint:e,runtime:p,serviceAdapter:o}).handle(s.req.raw,{})}})}async function O({mastraClient:e,resourceId:t}){let o=await e.getAgents();return Object.entries(o).reduce((n,[r])=>{let s=e.getAgent(r);return n[r]=new f({agentId:r,agent:s,resourceId:t}),n},{})}function T({mastra:e,resourceId:t,runtimeContext:o}){let n=e.getAgents()||{},s=(e.getNetworks()||[]).reduce((l,m)=>(l[m.name]=new f({agentId:m.name,agent:m,resourceId:t,runtimeContext:o}),l),{}),i=Object.entries(n).reduce((l,[m,p])=>(l[m]=new f({agentId:m,agent:p,resourceId:t,runtimeContext:o}),l),{});return C(C({},i),s)}function N({mastra:e,agentId:t,resourceId:o,runtimeContext:n}){let r=e.getAgent(t);if(!r)throw new Error(`Agent ${t} not found`);return new f({agentId:t,agent:r,resourceId:o,runtimeContext:n})}function k({mastra:e,networkId:t,resourceId:o,runtimeContext:n}){let r=e.getNetwork(t);if(!r)throw new Error(`Network ${t} not found`);return new f({agentId:r.name,agent:r,resourceId:o,runtimeContext:n})}var f=class extends d.AbstractAgent{constructor(s){var i=s,{agent:t,resourceId:o,runtimeContext:n}=i,r=S(i,["agent","resourceId","runtimeContext"]);super(r),this.agent=t,this.resourceId=o,this.runtimeContext=n}run(t){let o=(0,x.randomUUID)();return new j.Observable(n=>((async()=>{var i,l,m;let s={type:d.EventType.RUN_STARTED,threadId:t.threadId,runId:t.runId};if(n.next(s),"metrics"in this.agent){let a=this.agent.getMemory();if(a&&t.state&&Object.keys(t.state||{}).length>0){let c=await a.getThreadById({threadId:t.threadId});c||(c={id:t.threadId,title:"",metadata:{},resourceId:(i=this.resourceId)!=null?i:t.threadId,createdAt:new Date,updatedAt:new Date});let A=JSON.parse((m=(l=c.metadata)==null?void 0:l.workingMemory)!=null?m:"{}"),p=t.state,{messages:y}=p,M=S(p,["messages"]),h=JSON.stringify(C(C({},A),M));await a.saveThread({thread:R(C({},c),{metadata:R(C({},c.metadata),{workingMemory:h})})})}}try{await this.streamMastraAgent(t,{onTextPart:a=>{let c={type:d.EventType.TEXT_MESSAGE_CHUNK,role:"assistant",messageId:o,delta:a};n.next(c)},onToolCallPart:a=>{let c={type:d.EventType.TOOL_CALL_START,parentMessageId:o,toolCallId:a.toolCallId,toolCallName:a.toolName};n.next(c);let A={type:d.EventType.TOOL_CALL_ARGS,toolCallId:a.toolCallId,delta:JSON.stringify(a.args)};n.next(A);let y={type:d.EventType.TOOL_CALL_END,toolCallId:a.toolCallId};n.next(y)},onToolResultPart(a){let c={type:d.EventType.TOOL_CALL_RESULT,toolCallId:a.toolCallId,content:JSON.stringify(a.result),messageId:(0,x.randomUUID)(),role:"tool"};n.next(c)},onFinishMessagePart:async()=>{o=(0,x.randomUUID)()},onError:a=>{console.error("error",a),n.error(a)},onRunFinished:async()=>{if("metrics"in this.agent)try{let a=this.agent.getMemory();if(a){let c=await a.getWorkingMemory({threadId:t.threadId,memoryConfig:{workingMemory:{enabled:!0}}});if(typeof c=="string"){let A=JSON.parse(c);if(A&&!("$schema"in A)){let y={type:d.EventType.STATE_SNAPSHOT,snapshot:A};n.next(y)}}}}catch(a){console.error("Error sending state snapshot",a)}n.next({type:d.EventType.RUN_FINISHED,threadId:t.threadId,runId:t.runId}),n.complete()}})}catch(a){console.error("Stream error:",a),n.error(a)}})(),()=>{}))}async streamMastraAgent({threadId:t,runId:o,messages:n,tools:r},{onTextPart:s,onFinishMessagePart:i,onToolCallPart:l,onToolResultPart:m,onError:p,onRunFinished:a}){var _;let c=r.reduce((g,u)=>(g[u.name]={id:u.name,description:u.description,inputSchema:u.parameters},g),{}),A=(_=this.resourceId)!=null?_:t,y=L(n),M=this.runtimeContext;function h(g){return"metrics"in g}if(h(this.agent))try{let g=await this.agent.stream(y,{threadId:t,resourceId:A,runId:o,clientTools:c,runtimeContext:M});if(g&&typeof g=="object")if("toDataStreamResponse"in g&&typeof g.toDataStreamResponse=="function"){let u=g.toDataStreamResponse();if(u&&u.body)await(0,G.processDataStream)({stream:u.body,onTextPart:s,onToolCallPart:l,onToolResultPart:m,onFinishMessagePart:i}),await(a==null?void 0:a());else throw new Error("Invalid data stream response from local agent")}else await(0,G.processDataStream)({stream:g,onTextPart:s,onToolCallPart:l,onToolResultPart:m,onFinishMessagePart:i}),await(a==null?void 0:a());else throw new Error("Invalid response from local agent")}catch(g){p==null||p(g)}else try{let g=await this.agent.stream({threadId:t,resourceId:A,runId:o,messages:y,clientTools:c});if(g&&typeof g.processDataStream=="function")await g.processDataStream({onTextPart:s,onToolCallPart:l,onToolResultPart:m,onFinishMessagePart:i}),await(a==null?void 0:a());else throw new Error("Invalid response from remote agent")}catch(g){p==null||p(g)}}static async getRemoteAgents(t){return O(t)}static getLocalAgents(t){return T(t)}static getLocalAgent(t){return N(t)}static getNetwork(t){return k(t)}};0&&(module.exports={MastraAgent,convertAGUIMessagesToMastra,getLocalAgent,getLocalAgents,getNetwork,getRemoteAgents,registerCopilotKit});
+"use strict";var v=Object.defineProperty,B=Object.defineProperties,H=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertyNames,I=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var D=(e,t,o)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,C=(e,t)=>{for(var o in t||(t={}))E.call(t,o)&&D(e,o,t[o]);if(I)for(var o of I(t))U.call(t,o)&&D(e,o,t[o]);return e},R=(e,t)=>B(e,P(t));var S=(e,t)=>{var o={};for(var n in e)E.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(e!=null&&I)for(var n of I(e))t.indexOf(n)<0&&U.call(e,n)&&(o[n]=e[n]);return o};var K=(e,t)=>{for(var o in t)v(e,o,{get:t[o],enumerable:!0})},q=(e,t,o,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of $(t))!E.call(e,r)&&r!==o&&v(e,r,{get:()=>t[r],enumerable:!(n=H(t,r))||n.enumerable});return e};var W=e=>q(v({},"__esModule",{value:!0}),e);var z={};K(z,{MastraAgent:()=>f,convertAGUIMessagesToMastra:()=>L,getLocalAgent:()=>N,getLocalAgents:()=>T,getNetwork:()=>k,getRemoteAgents:()=>O,registerCopilotKit:()=>X});module.exports=W(z);var d=require("@ag-ui/client"),G=require("@ai-sdk/ui-utils"),x=require("crypto"),j=require("rxjs");var w=require("@copilotkit/runtime"),J=require("@mastra/core/server"),b=require("@mastra/core/runtime-context");function L(e){var o,n;let t=[];for(let r of e)if(r.role==="assistant"){let s=r.content?[{type:"text",text:r.content}]:[];for(let i of(o=r.toolCalls)!=null?o:[])s.push({type:"tool-call",toolCallId:i.id,toolName:i.function.name,args:JSON.parse(i.function.arguments)});t.push({role:"assistant",content:s})}else if(r.role==="user")t.push({role:"user",content:r.content||""});else if(r.role==="tool"){let s="unknown";for(let i of e)if(i.role==="assistant"){for(let l of(n=i.toolCalls)!=null?n:[])if(l.id===r.toolCallId){s=l.function.name;break}}t.push({role:"tool",content:[{type:"tool-result",toolCallId:r.toolCallId,toolName:s,result:r.content}]})}return t}function X({path:e,resourceId:t,serviceAdapter:o=new w.ExperimentalEmptyAdapter,agents:n,setContext:r}){return(0,J.registerApiRoute)(e,{method:"ALL",handler:async s=>{let i=s.get("mastra"),l=new b.RuntimeContext;r&&await r(s,l);let m=n||f.getLocalAgents({resourceId:t,mastra:i,runtimeContext:l}),p=new w.CopilotRuntime({agents:m});return(0,w.copilotRuntimeNodeHttpEndpoint)({endpoint:e,runtime:p,serviceAdapter:o}).handle(s.req.raw,{})}})}async function O({mastraClient:e,resourceId:t}){let o=await e.getAgents();return Object.entries(o).reduce((n,[r])=>{let s=e.getAgent(r);return n[r]=new f({agentId:r,agent:s,resourceId:t}),n},{})}function T({mastra:e,resourceId:t,runtimeContext:o}){let n=e.getAgents()||{},s=(e.getNetworks()||[]).reduce((l,m)=>(l[m.name]=new f({agentId:m.name,agent:m,resourceId:t,runtimeContext:o}),l),{}),i=Object.entries(n).reduce((l,[m,p])=>(l[m]=new f({agentId:m,agent:p,resourceId:t,runtimeContext:o}),l),{});return C(C({},i),s)}function N({mastra:e,agentId:t,resourceId:o,runtimeContext:n}){let r=e.getAgent(t);if(!r)throw new Error(`Agent ${t} not found`);return new f({agentId:t,agent:r,resourceId:o,runtimeContext:n})}function k({mastra:e,networkId:t,resourceId:o,runtimeContext:n}){let r=e.getNetwork(t);if(!r)throw new Error(`Network ${t} not found`);return new f({agentId:r.name,agent:r,resourceId:o,runtimeContext:n})}var f=class extends d.AbstractAgent{constructor(s){var i=s,{agent:t,resourceId:o,runtimeContext:n}=i,r=S(i,["agent","resourceId","runtimeContext"]);super(r),this.agent=t,this.resourceId=o,this.runtimeContext=n}run(t){let o=(0,x.randomUUID)();return new j.Observable(n=>((async()=>{var i,l,m;let s={type:d.EventType.RUN_STARTED,threadId:t.threadId,runId:t.runId};if(n.next(s),"metrics"in this.agent){let a=this.agent.getMemory();if(a&&t.state&&Object.keys(t.state||{}).length>0){let c=await a.getThreadById({threadId:t.threadId});c||(c={id:t.threadId,title:"",metadata:{},resourceId:(i=this.resourceId)!=null?i:t.threadId,createdAt:new Date,updatedAt:new Date});let A=JSON.parse((m=(l=c.metadata)==null?void 0:l.workingMemory)!=null?m:"{}"),p=t.state,{messages:y}=p,M=S(p,["messages"]),h=JSON.stringify(C(C({},A),M));await a.saveThread({thread:R(C({},c),{metadata:R(C({},c.metadata),{workingMemory:h})})})}}try{await this.streamMastraAgent(t,{onTextPart:a=>{let c={type:d.EventType.TEXT_MESSAGE_CHUNK,role:"assistant",messageId:o,delta:a};n.next(c)},onToolCallPart:a=>{let c={type:d.EventType.TOOL_CALL_START,parentMessageId:o,toolCallId:a.toolCallId,toolCallName:a.toolName};n.next(c);let A={type:d.EventType.TOOL_CALL_ARGS,toolCallId:a.toolCallId,delta:JSON.stringify(a.args)};n.next(A);let y={type:d.EventType.TOOL_CALL_END,toolCallId:a.toolCallId};n.next(y)},onToolResultPart(a){let c={type:d.EventType.TOOL_CALL_RESULT,toolCallId:a.toolCallId,content:JSON.stringify(a.result),messageId:(0,x.randomUUID)(),role:"tool"};n.next(c)},onFinishMessagePart:async()=>{o=(0,x.randomUUID)()},onError:a=>{console.error("error",a),n.error(a)},onRunFinished:async()=>{if("metrics"in this.agent)try{let a=this.agent.getMemory();if(a){let c=await a.getWorkingMemory({threadId:t.threadId,memoryConfig:{workingMemory:{enabled:!0}}});if(typeof c=="string"){let A=JSON.parse(c);if(A&&!("$schema"in A)){let y={type:d.EventType.STATE_SNAPSHOT,snapshot:A};n.next(y)}}}}catch(a){console.error("Error sending state snapshot",a)}n.next({type:d.EventType.RUN_FINISHED,threadId:t.threadId,runId:t.runId}),n.complete()}})}catch(a){console.error("Stream error:",a),n.error(a)}})(),()=>{}))}async streamMastraAgent({threadId:t,runId:o,messages:n,tools:r},{onTextPart:s,onFinishMessagePart:i,onToolCallPart:l,onToolResultPart:m,onError:p,onRunFinished:a}){var _;let c=r.reduce((g,u)=>(g[u.name]={id:u.name,description:u.description,inputSchema:u.parameters},g),{}),A=(_=this.resourceId)!=null?_:t,y=L(n),M=this.runtimeContext;function h(g){return"metrics"in g}if(h(this.agent))try{let g=await this.agent.stream(y,{threadId:t,resourceId:A,runId:o,clientTools:c,runtimeContext:M});if(g&&typeof g=="object")if("toDataStreamResponse"in g&&typeof g.toDataStreamResponse=="function"){let u=g.toDataStreamResponse();if(u&&u.body)await(0,G.processDataStream)({stream:u.body,onTextPart:s,onToolCallPart:l,onToolResultPart:m,onFinishMessagePart:i}),await(a==null?void 0:a());else throw new Error("Invalid data stream response from local agent")}else await(0,G.processDataStream)({stream:g,onTextPart:s,onToolCallPart:l,onToolResultPart:m,onFinishMessagePart:i}),await(a==null?void 0:a());else throw new Error("Invalid response from local agent")}catch(g){p==null||p(g)}else try{let g=await this.agent.stream(y,{threadId:t,resourceId:A,runId:o,clientTools:c,runtimeContext:M});if(g&&typeof g=="object")if("toDataStreamResponse"in g&&typeof g.toDataStreamResponse=="function"){let u=g.toDataStreamResponse();if(u&&u.body)await(0,G.processDataStream)({stream:u.body,onTextPart:s,onToolCallPart:l,onToolResultPart:m,onFinishMessagePart:i}),await(a==null?void 0:a());else throw new Error("Invalid data stream response from local agent")}else await(0,G.processDataStream)({stream:g,onTextPart:s,onToolCallPart:l,onToolResultPart:m,onFinishMessagePart:i}),await(a==null?void 0:a());else throw new Error("Invalid response from local agent")}catch(g){p==null||p(g)}}static async getRemoteAgents(t){return O(t)}static getLocalAgents(t){return T(t)}static getLocalAgent(t){return N(t)}static getNetwork(t){return k(t)}};0&&(module.exports={MastraAgent,convertAGUIMessagesToMastra,getLocalAgent,getLocalAgents,getNetwork,getRemoteAgents,registerCopilotKit});